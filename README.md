# æŠ•è³‡ç­–ç•¥æ¯”è¼ƒç³»çµ±

åŸºæ–¼ç¬¬ä¸€ç« éœ€æ±‚è¦æ ¼å¯¦ç¾çš„ Value Averaging (VA) vs Dollar Cost Averaging (DCA) æŠ•è³‡ç­–ç•¥æ¯”è¼ƒç³»çµ±ã€‚

## å°ˆæ¡ˆæ¦‚è¿°

æœ¬ç³»çµ±æ—¨åœ¨æä¾›ä¸€å€‹äº’å‹•å¼å¹³å°ï¼Œæ¯”è¼ƒå®šæœŸå®šå€¼(VA)èˆ‡å®šæœŸå®šé¡(DCA)å…©ç¨®æŠ•è³‡ç­–ç•¥çš„ç¸¾æ•ˆè¡¨ç¾ã€‚ç³»çµ±æ”¯æ´æ­·å²æ•¸æ“šå›æ¸¬èˆ‡æ¨¡æ“¬æƒ…å¢ƒåˆ†æï¼Œæä¾›å®Œæ•´çš„ç¸¾æ•ˆæ¯”è¼ƒèˆ‡æ•¸æ“šä¸‹è¼‰åŠŸèƒ½ã€‚

## ç³»çµ±æ¶æ§‹

### ç¬¬ä¸€ç« å¯¦ç¾ï¼šæ•¸æ“šæºèˆ‡è³‡è¨Šæµå®šç¾©

å·²å®Œæˆç¬¬ä¸€ç« çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„ï¼š

#### 1. æ•¸æ“šæ¨¡å‹ (`src/models/data_models.py`)
- `MarketDataPoint`: å–®æ—¥å¸‚å ´æ•¸æ“šçµæ§‹
- `AggregatedPeriodData`: æœŸé–“èšåˆæ•¸æ“šçµæ§‹  
- `StrategyResult`: ç­–ç•¥è¨ˆç®—çµæœçµæ§‹
- `DataModelFactory`: æ•¸æ“šæ¨¡å‹å·¥å» é¡

#### 2. APIå®‰å…¨æ©Ÿåˆ¶ (`src/utils/api_security.py`)
- å¤šå±¤ç´šAPIé‡‘é‘°ç²å–ç­–ç•¥ (Streamlit Secrets â†’ ç’°å¢ƒè®Šæ•¸ â†’ .envæ–‡ä»¶)
- APIé‡‘é‘°æ ¼å¼é©—è­‰
- APIé€£é€šæ€§æ¸¬è©¦
- å®‰å…¨è«‹æ±‚èˆ‡é‡è©¦æ©Ÿåˆ¶

#### 3. äº¤æ˜“æ—¥è™•ç† (`src/utils/trading_days.py`)
- ç¾åœ‹è‚¡å¸‚å‡æœŸç®¡ç†
- äº¤æ˜“æ—¥é©—è­‰èˆ‡èª¿æ•´
- æ¨¡æ“¬æ™‚é–“è»¸ç”Ÿæˆ
- æœŸé–“æ—¥æœŸè¨ˆç®—

#### 4. APIå®¢æˆ¶ç«¯ (`src/data_sources/api_clients.py`)
- **TiingoAPIClient**: SPYè‚¡ç¥¨æ•¸æ“šç²å–
- **FREDAPIClient**: 1å¹´æœŸåœ‹å‚µæ®–åˆ©ç‡æ•¸æ“šç²å–
- **MarketDataProvider**: çµ±ä¸€å¸‚å ´æ•¸æ“šä»‹é¢
- å„ªåŒ–çš„æ‰¹æ¬¡æ•¸æ“šç²å–åŠŸèƒ½

#### 5. æ¨¡æ“¬æ•¸æ“šç”Ÿæˆ (`src/data_sources/simulation.py`)
- **MarketSimulator**: ä½¿ç”¨å¹¾ä½•å¸ƒæœ—é‹å‹•ç”Ÿæˆè‚¡ç¥¨åƒ¹æ ¼
- **Vasicekæ¨¡å‹**: ç”Ÿæˆå‚µåˆ¸æ®–åˆ©ç‡
- ç‰›ç†Šå¸‚å ´æƒ…å¢ƒæ¨¡æ“¬
- **SimulationDataProvider**: å®Œæ•´æ¨¡æ“¬æ•¸æ“šæä¾›è€…

#### 6. çµ±ä¸€æ•¸æ“šç®¡ç† (`src/data_manager.py`)
- **DataManager**: çµ±ä¸€æ•¸æ“šç®¡ç†ä»‹é¢
- è‡ªå‹•æ•¸æ“šæºé¸æ“‡ (APIå„ªå…ˆï¼Œé™ç´šåˆ°æ¨¡æ“¬)
- æ•¸æ“šå“è³ªé©—è­‰
- æœŸé–“æ•¸æ“šèšåˆ

## å®‰è£èˆ‡è¨­å®š

### 1. å®‰è£ä¾è³´å¥—ä»¶

```bash
pip install -r requirements.txt
```

### 2. è¨­å®šAPIé‡‘é‘° (å¯é¸)

è¤‡è£½ `config/env_example.txt` çš„å…§å®¹åˆ°å°ˆæ¡ˆæ ¹ç›®éŒ„çš„ `.env` æ–‡ä»¶ï¼š

```bash
# .env
TIINGO_API_KEY=your_tiingo_api_key_here
FRED_API_KEY=your_fred_api_key_here
```

**å–å¾—APIé‡‘é‘°ï¼š**
- [Tiingo API](https://api.tiingo.com/) - å…è²»è¨»å†Šå³å¯å–å¾—è‚¡ç¥¨æ•¸æ“šAPIé‡‘é‘°
- [FRED API](https://fred.stlouisfed.org/docs/api/api_key.html) - å…è²»è¨»å†Šå³å¯å–å¾—ç¶“æ¿Ÿæ•¸æ“šAPIé‡‘é‘°

**æ³¨æ„ï¼š** å¦‚æœæ²’æœ‰è¨­å®šAPIé‡‘é‘°ï¼Œç³»çµ±æœƒè‡ªå‹•ä½¿ç”¨æ¨¡æ“¬æ•¸æ“šï¼ŒåŠŸèƒ½å®Œå…¨æ­£å¸¸ã€‚

### 3. æ¸¬è©¦ç³»çµ±åŠŸèƒ½

```bash
python test_chapter1.py
```

æ­¤æ¸¬è©¦è…³æœ¬æœƒé©—è­‰æ‰€æœ‰ç¬¬ä¸€ç« åŠŸèƒ½ï¼š
- APIå®‰å…¨æ©Ÿåˆ¶
- äº¤æ˜“æ—¥è™•ç†
- æ¨¡æ“¬æ™‚é–“è»¸ç”Ÿæˆ
- æ¨¡æ“¬æ•¸æ“šç”Ÿæˆ
- APIæ•¸æ“šç²å– (å¦‚æœå¯ç”¨)
- æœŸé–“æ•¸æ“šèšåˆ

## ä¸»è¦ç‰¹è‰²

### ğŸ” å¤šå±¤ç´šå®‰å…¨æ©Ÿåˆ¶
- æ”¯æ´ Streamlit Cloud Secrets (é›²ç«¯éƒ¨ç½²)
- ç’°å¢ƒè®Šæ•¸é…ç½® (ä¼ºæœå™¨éƒ¨ç½²)
- .envæª”æ¡ˆé…ç½® (æœ¬åœ°é–‹ç™¼)
- APIé‡‘é‘°æ ¼å¼é©—è­‰èˆ‡é€£é€šæ€§æ¸¬è©¦

### ğŸ“Š æ™ºæ…§æ•¸æ“šæºç®¡ç†
- **APIå„ªå…ˆç­–ç•¥**: å„ªå…ˆä½¿ç”¨çœŸå¯¦å¸‚å ´æ•¸æ“š
- **è‡ªå‹•é™ç´š**: APIä¸å¯ç”¨æ™‚è‡ªå‹•åˆ‡æ›åˆ°æ¨¡æ“¬æ•¸æ“š
- **æ‰¹æ¬¡å„ªåŒ–**: æ¸›å°‘APIèª¿ç”¨æ¬¡æ•¸ï¼Œæå‡æ•ˆèƒ½
- **æ•¸æ“šé©—è­‰**: å®Œæ•´çš„æ•¸æ“šå“è³ªæª¢æŸ¥æ©Ÿåˆ¶

### ğŸ—“ï¸ ç²¾ç¢ºäº¤æ˜“æ—¥è™•ç†
- ç¾åœ‹è‚¡å¸‚å‡æœŸç®¡ç†
- éäº¤æ˜“æ—¥è‡ªå‹•èª¿æ•´
- æ”¯æ´å¤šç¨®æŠ•è³‡é »ç‡ (æ¯æœˆ/æ¯å­£/æ¯åŠå¹´/æ¯å¹´)
- å®Œæ•´çš„æ™‚é–“è»¸ç”Ÿæˆèˆ‡é©—è­‰

### ğŸ² é«˜å“è³ªæ¨¡æ“¬å¼•æ“
- **å¹¾ä½•å¸ƒæœ—é‹å‹•**: è‚¡ç¥¨åƒ¹æ ¼æ¨¡æ“¬
- **Vasicekæ¨¡å‹**: å‚µåˆ¸æ®–åˆ©ç‡æ¨¡æ“¬
- **æƒ…å¢ƒåˆ‡æ›**: ç‰›å¸‚ç†Šå¸‚è‡ªå‹•è½‰æ›
- **å¯é‡ç¾çµæœ**: æ”¯æ´éš¨æ©Ÿç¨®å­è¨­å®š

### ğŸ“ˆ æ•¸æ“šæºå¤šæ¨£æ€§
- **Tiingo API**: SPYè‚¡ç¥¨æ­·å²æ•¸æ“š
- **FRED API**: ç¾åœ‹åœ‹å‚µæ®–åˆ©ç‡æ•¸æ“š
- **æ¨¡æ“¬å¼•æ“**: æœªä¾†æƒ…å¢ƒæ•¸æ“šç”Ÿæˆ
- **æ··åˆæ¨¡å¼**: è‡ªå‹•é¸æ“‡æœ€ä½³æ•¸æ“šæº

## ç›®éŒ„çµæ§‹

```
VA_DC_APP7/
â”œâ”€â”€ src/                      # æºä»£ç¢¼ç›®éŒ„
â”‚   â”œâ”€â”€ models/              # æ•¸æ“šæ¨¡å‹
â”‚   â”‚   â””â”€â”€ data_models.py   # æ ¸å¿ƒæ•¸æ“šçµæ§‹
â”‚   â”œâ”€â”€ utils/               # å·¥å…·æ¨¡çµ„
â”‚   â”‚   â”œâ”€â”€ api_security.py  # APIå®‰å…¨æ©Ÿåˆ¶
â”‚   â”‚   â””â”€â”€ trading_days.py  # äº¤æ˜“æ—¥è™•ç†
â”‚   â”œâ”€â”€ data_sources/        # æ•¸æ“šæºæ¨¡çµ„
â”‚   â”‚   â”œâ”€â”€ api_clients.py   # APIå®¢æˆ¶ç«¯
â”‚   â”‚   â””â”€â”€ simulation.py    # æ¨¡æ“¬æ•¸æ“šç”Ÿæˆ
â”‚   â””â”€â”€ data_manager.py      # çµ±ä¸€æ•¸æ“šç®¡ç†
â”œâ”€â”€ config/                  # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ env_example.txt     # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”œâ”€â”€ requirements.txt         # ä¾è³´å¥—ä»¶
â”œâ”€â”€ test_chapter1.py        # ç¬¬ä¸€ç« åŠŸèƒ½æ¸¬è©¦
â”œâ”€â”€ requirements.md         # å®Œæ•´éœ€æ±‚è¦æ ¼
â””â”€â”€ README.md              # æœ¬æ–‡ä»¶
```

## ä½¿ç”¨ç¯„ä¾‹

### åŸºæœ¬æ•¸æ“šç²å–

```python
from src.data_manager import DataManager

# åˆå§‹åŒ–æ•¸æ“šç®¡ç†å™¨
data_manager = DataManager()

# ç²å–å¸‚å ´æ•¸æ“š (è‡ªå‹•é¸æ“‡æœ€ä½³æ•¸æ“šæº)
market_data = data_manager.get_market_data(
    start_date="2023-01-01",
    end_date="2023-12-31"
)

print(f"ç²å–äº† {len(market_data)} ç­†å¸‚å ´æ•¸æ“š")
```

### æœŸé–“æ•¸æ“šèšåˆ

```python
# ç²å–å­£åº¦æŠ•è³‡æ•¸æ“š
period_data = data_manager.get_period_data(
    investment_years=3,
    frequency='quarterly',
    data_source='auto'  # è‡ªå‹•é¸æ“‡
)

for period in period_data:
    print(f"ç¬¬{period.period}æœŸ: {period.period_return:.2%} å ±é…¬ç‡")
```

### æ¨¡æ“¬æ•¸æ“šç”Ÿæˆ

```python
# å¼·åˆ¶ä½¿ç”¨æ¨¡æ“¬æ•¸æ“š
simulation_data = data_manager.get_market_data(
    start_date="2026-01-01",
    end_date="2028-12-31",
    data_source="simulation"
)

print(f"ç”Ÿæˆäº† {len(simulation_data)} ç­†æ¨¡æ“¬æ•¸æ“š")
```

## ç³»çµ±ç‹€æ…‹æª¢æŸ¥

```python
# æª¢æŸ¥æ•¸æ“šæºç‹€æ…‹
status = data_manager.get_data_source_status()
print(f"æ¨è–¦æ•¸æ“šæº: {status['recommended_source']}")
print(f"å¯ç”¨API: {status['available_sources']}")

# æ•¸æ“šå“è³ªé©—è­‰
quality_report = data_manager.validate_data_quality(market_data)
print(f"æ•¸æ“šå®Œæ•´åº¦: {quality_report['statistics']['data_completeness']}")
```

## ä¸‹ä¸€éšæ®µé–‹ç™¼

ç¬¬ä¸€ç« çš„æ•¸æ“šåŸºç¤æ¶æ§‹å·²å®Œæˆï¼Œæ¥ä¸‹ä¾†å°‡å¯¦ç¾ï¼š

- **ç¬¬äºŒç« **: è¡¨æ ¼èˆ‡åœ–è¡¨æ¶æ§‹èˆ‡å…¬å¼æ¨¡çµ„
  - VA/DCAç­–ç•¥è¨ˆç®—å¼•æ“
  - ç¸¾æ•ˆæŒ‡æ¨™è¨ˆç®—
  - åœ–è¡¨ç”Ÿæˆèˆ‡è¦–è¦ºåŒ–

- **ç¬¬ä¸‰ç« **: Streamlitç”¨æˆ¶ä»‹é¢
  - åƒæ•¸è¼¸å…¥æ§åˆ¶
  - å³æ™‚è¨ˆç®—èˆ‡åœ–è¡¨é¡¯ç¤º
  - æ•¸æ“šä¸‹è¼‰åŠŸèƒ½

## æŠ€è¡“è¦æ ¼

- **Python 3.8+**
- **æ•¸æ“šè™•ç†**: pandas, numpy
- **APIèª¿ç”¨**: requests
- **æ—¥æœŸè™•ç†**: python-dateutil, holidays
- **è¦–è¦ºåŒ–**: altair, plotly (å¾…å¯¦ç¾)
- **UIæ¡†æ¶**: streamlit (å¾…å¯¦ç¾)

## æˆæ¬Šè²æ˜

æœ¬å°ˆæ¡ˆä¾æ“šéœ€æ±‚è¦æ ¼æ–‡ä»¶é–‹ç™¼ï¼Œåƒ…ä¾›å­¸ç¿’å’Œç ”ç©¶ä½¿ç”¨ã€‚ # VA_DC_APP7
